<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Connect with licensed psychologists and counselors at Soulamore. Professional mental health support for students.">
    <title>Our Psychologists | Soulamore</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/global.css">

    <style>
        /* --- THEME: CLINICAL CALM --- */
        :root {
            --deep-space: #0f172a;
            --navy-glass: rgba(30, 41, 59, 0.9);
            --starlight: #f1f5f9;
            --teal-glow: #4ECDC4;
            --clinical-blue: #0ea5e9;
            --border-glass: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--deep-space);
            color: var(--starlight);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1,
        h2,
        h3 {
            font-family: 'Outfit', sans-serif;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            position: relative;
            z-index: 5;
        }

        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero {
            text-align: center;
            /* padding: 180px 0 60px; REMOVED FOR SHELL STANDARD */
            padding-bottom: 60px;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            line-height: 1.1;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.8;
            max-width: 700px;
            margin: 0 auto;
            font-weight: 300;
        }

        .badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 50px;
            background: rgba(14, 165, 233, 0.1);
            color: var(--clinical-blue);
            font-size: 0.85rem;
            margin-bottom: 20px;
            border: 1px solid rgba(14, 165, 233, 0.3);
        }

        /* --- FILTERS --- */
        .filter-section {
            margin-bottom: 60px;
            text-align: center;
        }

        .filter-bar {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-select {
            background: var(--navy-glass);
            color: var(--starlight);
            border: 1px solid var(--border-glass);
            padding: 10px 20px;
            border-radius: 8px;
            outline: none;
            cursor: pointer;
        }

        /* --- GRID --- */
        .psych-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 100px;
        }

        .psych-card {
            background: var(--navy-glass);
            border: 1px solid var(--border-glass);
            border-radius: 24px;
            padding: 30px;
            text-align: center;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .psych-card:hover {
            transform: translateY(-5px);
            border-color: var(--clinical-blue);
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin-bottom: 20px;
            background: #e2e8f0;
            color: #334155;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .title {
            color: var(--clinical-blue);
            font-size: 0.9rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .quote {
            font-style: italic;
            opacity: 0.8;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 25px;
        }

        .tag {
            font-size: 0.75rem;
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .view-btn {
            background: transparent;
            border: 1px solid var(--starlight);
            color: white;
            padding: 10px 30px;
            border-radius: 50px;
            text-decoration: none;
            transition: 0.3s;
            font-weight: 600;
            width: 100%;
        }

        .view-btn:hover {
            background: white;
            color: var(--deep-space);
        }
    </style>
    <link rel="icon" href="../assets/images/favicon_symbol.png" type="image/x-icon">
</head>

<body>
    <!-- GLOBAL HEADER -->
    <!-- APP SHELL START -->
    <div id="app-shell">
        <div id="shell-fixed">
            <header id="main-header"></header>
        </div>

        <main id="shell-content">
            <div class="container">
                <section class="hero fade-in">
                    <div class="badge">Verified Professionals</div>
                    <h1 class="hero-title-premium" style="margin-bottom: 20px;">Clinical Support & Therapy</h1>
                    <p>Connect with licensed psychologists and counselors for anxiety, depression, and personal growth.
                        Evidence-based care in a safe space.</p>
                </section>

                <!-- FILTERS -->
                <div class="filter-section fade-in">
                    <div class="filter-bar">
                        <select class="filter-select" id="specFilter" onchange="filterPsychs()">
                            <option value="all">Specialization: All</option>
                            <option value="Anxiety">Anxiety</option>
                            <option value="Depression">Depression</option>
                            <option value="Relationships">Relationships</option>
                            <option value="Trauma">Trauma</option>
                        </select>
                        <select class="filter-select" id="langFilter" onchange="filterPsychs()">
                            <option value="all">Language: All</option>
                            <option value="English">English</option>
                            <option value="Hindi">Hindi</option>
                        </select>
                    </div>
                </div>

                <!-- GRID -->
                <div class="psych-grid" id="psychGrid">
                    <!-- Injected via JS -->
                </div>
            </div>
        </main>
    </div>
    <!-- APP SHELL END -->

    <!-- STANDARDIZED FOOTER -->
    <footer></footer>

    <script src="../assets/js/components.js"></script>
    <script type="module">
        import { db, collection, getDocs } from "../assets/js/firebase-config.js";

        // Global State
        let psychs = [];
        let fetchedPsychs = [];

        async function fetchPsychs() {
            try {
                // Initial Loading State
                const grid = document.getElementById('psychGrid');
                if (grid) grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding: 40px; opacity: 0.7;">Loading professionals...</div>';

                // Timeout Promise (2.5 seconds limit - Faster Fallback)
                const timeout = new Promise((_, reject) =>
                    setTimeout(() => reject(new Error("Request timed out")), 2500)
                );

                // Data Promise
                const dataFetch = getDocs(collection(db, "professionals"));

                // Race them
                const querySnapshot = await Promise.race([dataFetch, timeout]);

                fetchedPsychs = [];

                querySnapshot.forEach((doc) => {
                    const data = doc.data();

                    // Filter Logic:
                    // Check if role indicates a professional (Psychologist, Therapist, Counselor)
                    const role = data.role || data.title || "";
                    const isPsych = role.includes('Psychologist') || role.includes('Therapist') || role.includes('Counselor') || data.isPsych === true;

                    if (isPsych && role !== "Peer Listener") {
                        fetchedPsychs.push({
                            id: doc.id,
                            name: data.name,
                            role: role || "Clinical Psychologist",
                            category: data.category || "Mental Wellness",
                            image: data.photoURL,
                            avatarColor: data.avatarColor || "#F49F75",
                            color: data.color || "#fff",
                            tags: data.tags || [],
                            rating: data.rating || 5.0,
                            reviews: data.reviews || 0,
                            price: data.rate || 1500,
                            exp: data.experience || "5",
                            lang: data.languages || "English",
                            online: data.onlineStatus === 'online',
                            verified: data.verified !== false,
                            profileUrl: `../our-peers/profile.html?id=${doc.id}`
                        });
                    }
                });

                // FALLBACK if empty
                if (fetchedPsychs.length === 0) {
                    console.warn("No psychologists found in Firestore. Using fallback demo data.");
                    throw new Error("Empty DB");
                } else {
                    psychs = fetchedPsychs;
                    renderPsychs();
                }

            } catch (error) {
                console.warn("Using fallback data due to error:", error);

                // Fallback Data
                psychs = [
                    {
                        id: 5,
                        name: "Bhagyavathi",
                        role: "Counseling Psychologist",
                        category: "Trauma & Abuse",
                        image: "",
                        avatarColor: "#F49F75",
                        color: "#fff",
                        tags: ["Trauma", "Narcissistic Abuse", "Relationships", "English"],
                        rating: 4.9,
                        reviews: 21,
                        price: 1000,
                        exp: "4",
                        lang: "English, Tamil",
                        online: true,
                        verified: true,
                        profileUrl: "../our-peers/profile.html?id=5"
                    },
                    {
                        id: 1,
                        name: "Palak Shori",
                        role: "Clinical Psychologist (Master's)",
                        category: "Mental Wellness",
                        image: "https://via.placeholder.com/150/FF5733/FFFFFF?text=PS",
                        tags: ["Anxiety", "Depression", "Youth Counseling", "English", "Hindi"],
                        rating: 4.9,
                        reviews: 120,
                        price: 1800,
                        exp: "8",
                        lang: "English, Hindi",
                        online: true,
                        verified: true,
                        profileUrl: "../our-peers/profile.html?id=1"
                    },
                    {
                        id: 2,
                        name: "Dr. Ananya Gupta",
                        role: "Senior Therapist (PhD)",
                        category: "Relationship Counseling",
                        image: "https://via.placeholder.com/150/33FF57/FFFFFF?text=AG",
                        tags: ["Trauma", "Relationships", "Stress", "English"],
                        rating: 4.8,
                        reviews: 95,
                        price: 2500,
                        exp: "15",
                        lang: "English",
                        online: false,
                        verified: true,
                        profileUrl: "#"
                    }
                ];
                renderPsychs();
            }
        }

        // --- RENDER FUNCTION ---
        function renderPsychs() {
            const grid = document.getElementById('psychGrid');
            const specVal = document.getElementById('specFilter').value;
            const langVal = document.getElementById('langFilter').value;

            const filtered = psychs.filter(p => {
                const tagMatch = specVal === 'all' || (p.tags && p.tags.includes(specVal)) || (p.category && p.category.includes(specVal));
                const langMatch = langVal === 'all' || (p.lang && p.lang.includes(langVal));
                return tagMatch && langMatch;
            });

            if (filtered.length === 0) {
                grid.innerHTML = '<p style="grid-column:1/-1; text-align:center; opacity:0.7; margin-top:20px;">No professionals found matching these filters.</p>';
                return;
            }

            grid.innerHTML = filtered.map(psych => `
                <div class="psych-card fade-in">
                    <div class="avatar" style="background:${psych.avatarColor || '#e2e8f0'}; color:${psych.color || '#334155'};">
                        ${psych.image && !psych.image.includes('via.placeholder') && !psych.image.includes('assets/images/default') ? `<img src="${psych.image}" style="width:100%; height:100%; object-fit:cover; border-radius:50%;" alt="${psych.name}">` : psych.name.charAt(0)}
                    </div>
                    ${psych.verified ? '<div class="badge" style="margin-bottom:10px; padding:2px 8px; font-size:0.7rem;"><i class="fas fa-check-circle"></i> Verified</div>' : ''}
                    
                    <h3 class="name">${psych.name}</h3>
                    <div class="title">${psych.role}</div>
                    
                    <div class="tags">
                         ${psych.category ? `<span class="tag" style="background:rgba(14, 165, 233, 0.2); color:var(--clinical-blue);">${psych.category}</span>` : ''}
                         ${psych.tags.slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('')} 
                    </div>

                     <div style="font-style:italic; opacity:0.7; font-size:0.85rem; margin-bottom:15px;">
                        <i class="fas fa-star" style="color:var(--gold-glow);"></i> ${psych.rating} (${psych.reviews} reviews) • ${psych.exp}+ Yrs Exp
                    </div>

                    <div style="margin-bottom:20px; font-size:0.9rem; opacity:0.8;">
                       <i class="fas fa-language"></i> ${psych.lang}
                    </div>

                    <div style="margin-top:auto; width:100%;">
                         <div style="font-weight:700; font-size:1.2rem; margin-bottom:15px; color:var(--teal-glow);">₹${psych.price} <span style="font-size:0.8rem; opacity:0.6; color:var(--starlight);">/ session</span></div>
                        <a href="${psych.profileUrl || '../our-peers/profile.html?id=' + psych.id}" class="view-btn">View Profile</a>
                    </div>
                </div>
            `).join('');
        }

        // Expose function for HTML onchange events
        window.filterPsychs = renderPsychs;

        fetchPsychs();
    </script>
</body>

</html>