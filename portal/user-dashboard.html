<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- AUTH GUARD: Protects this page -->
    <script src="../assets/js/auth-guard.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Space | Soulamore</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="../assets/css/dashboard-sidebar.css">
    <style>
        /* ==============================================
           SOULAMORE COMPLETE THEME SYSTEM
           Themes Regulate Perception, Not Appearance
           ============================================== */

        :root {
            /* ========================================
               GLOBAL INVARIANTS (NEVER CHANGE)
               Identity Color Therapy - LOCKED
               ======================================== */

            /* Peer Support = Peach (hue never changes) */
            --accent-peer: #f49f75;
            --peach-glow: #f49f75;
            --peach-soft: rgba(244, 159, 117, 0.15);
            --peach-bg: rgba(244, 159, 117, 0.05);
            --peach-border: rgba(244, 159, 117, 0.2);

            /* GLOBAL GOLD (Added for Premium Feel) */
            --gold-glow: #fbbf24;
            --gold-dim: rgba(251, 191, 36, 0.15);

            /* Professional Support = Teal (hue never changes) */
            --accent-professional: #2dd4bf;
            --teal-accent: #2dd4bf;
            --teal-dim: rgba(45, 212, 191, 0.1);
            --teal-glow: #4ecdc4;
            --teal-border: rgba(45, 212, 191, 0.2);

            /* ========================================
               GLOBAL NEUTRAL TOKENS (Theme-Invariant Structure)
               ======================================== */
            --bg-base-light: #ffffff;
            --bg-base-dark: #0f172a;
            --surface-primary: #1e293b;
            --surface-secondary: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-soft: rgba(255, 255, 255, 0.08);
            --border-strong: rgba(255, 255, 255, 0.15);
            --shadow-soft: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.2);
            --shadow-dense: rgba(0, 0, 0, 0.4);

            /* ========================================
               THEME MODULATION TOKENS (What Themes Control)
               Default: Calm (Night, quiet, safe)
               ======================================== */
            --theme-undertone: cool;
            --theme-accent-opacity: 0.7;
            --theme-contrast-level: medium;
            --theme-shadow-density: soft;
            --theme-shadow-blur: 12px;
            --theme-shadow-y: 4px;
            --theme-glow-opacity: 0.08;
            --theme-glow-radius: 20px;
            --theme-motion-speed: 400ms;
            --theme-motion-easing: cubic-bezier(0.4, 0, 0.2, 1);
            --theme-focus-ring-strength: medium;

            /* Page & Background */
            --bg-deep: #0f172a;
            --bg-card: #1e293b;
            --bg-sidebar: #0f172a;
            --bg-gradient: linear-gradient(180deg, #0f172a 0%, #0a0f1a 100%);
            --bg-visual-pressure: very-low;

            /* Typography - FIX: Ensure light text in dark mode */
            --text-main: #f8fafc;
            /* FIXED: Bright white for main headings */
            --text-primary: #f8fafc;
            /* FIXED: Bright white for primary text */
            --text-secondary: #cbd5e1;
            /* FIXED: Light gray for secondary text */
            --text-muted: #94a3b8;
            /* FIXED: Medium gray for muted text */
            --opacity-primary: 0.95;
            --opacity-secondary: 0.65;
            --opacity-muted: 0.45;
            --opacity-disabled: 0.3;
            --text-line-height: 1.7;
            --text-letter-spacing: normal;
            --text-weight: 400;

            /* Borders & Surfaces */
            --border-subtle: rgba(255, 255, 255, 0.08);
            --border-opacity: 0.08;
            --border-radius: 12px;
            --border-width: 1px;
            --surface-contrast: medium;

            /* Shadows */
            --shadow-color: rgba(0, 0, 0, 0.3);

            /* Glow (Functional Only) */
            --glow-focus-color: rgba(45, 212, 191, 0.3);
            --glow-focus-opacity: 0.08;
            --glow-focus-radius: 20px;

            /* Buttons */
            --btn-fill-opacity: 0.7;
            --btn-border-clarity: medium;
            --btn-press-depth: 2px;

            /* Navigation */
            --nav-contrast: medium;
            --nav-icon-opacity: 0.8;

            /* Scrollbars */
            --scrollbar-thumb-opacity: 0.3;
            --scrollbar-hover-boost: 0.05;

            /* Fonts */
            --font-head: 'Outfit', sans-serif;
            --font-body: 'Plus Jakarta Sans', sans-serif;
        }

        /* ========================================
           CALM (Default Baseline)
           "I am safe. I can stay here."
           Night, quiet room, no urgency
           Note: Already defined in :root
           ======================================== */

        /* ========================================
           LIBRARY FOG (was "Neutral")
           "I want to exist without stimulation."
           Library, fog, early morning - UI disappears
           ======================================== */
        html[data-theme="library-fog"],
        body[data-theme="library-fog"] {
            --theme-undertone: neutral;
            --theme-contrast-level: low;
            --theme-shadow-density: flat;
            --theme-shadow-blur: 6px;
            --theme-shadow-y: 2px;
            --theme-glow-opacity: 0.03;
            --theme-glow-radius: 8px;
            --theme-motion-speed: 500ms;
            --theme-motion-easing: linear;

            --bg-deep: #0f1114;
            --bg-card: #171a1d;
            --bg-gradient: linear-gradient(180deg, #0f1114 0%, #0a0c0e 100%);

            --opacity-primary: 0.78;
            --opacity-secondary: 0.58;
            --text-muted: #7d8a9f;

            --border-opacity: 0.05;
            --border-width: 0.5px;
            --surface-contrast: low;

            --btn-fill-opacity: 0.35;
            --btn-border-clarity: low;

            --nav-contrast: low;
            --nav-icon-opacity: 0.65;

            --scrollbar-thumb-opacity: 0.2;
            --scrollbar-hover-boost: 0.03;

            filter: saturate(0.75);
        }

        /* ========================================
           EARTH WEIGHT (was "Grounded")
           "I need stability. I need weight."
           Earth, stillness, gravity - Physical stability
           ======================================== */
        html[data-theme="earth-weight"],
        body[data-theme="earth-weight"] {
            --theme-undertone: warm;
            --theme-contrast-level: medium;
            --theme-shadow-density: dense;
            --theme-shadow-blur: 8px;
            --theme-shadow-y: 6px;
            --theme-glow-opacity: 0;
            --theme-glow-radius: 15px;
            --theme-motion-speed: 400ms;
            --theme-motion-easing: cubic-bezier(0.3, 0, 0.1, 1);

            --bg-deep: #10100e;
            --bg-card: #1a1916;
            --bg-gradient: linear-gradient(180deg, #10100e 0%, #0d0c0b 100%);

            --opacity-primary: 0.9;
            --opacity-secondary: 0.7;

            --border-opacity: 0.12;
            --border-width: 2px;
            --border-radius: 6px;
            --surface-contrast: medium;

            --shadow-color: rgba(0, 0, 0, 0.5);

            --btn-fill-opacity: 0.6;
            --btn-border-clarity: high;
            --btn-press-depth: 4px;

            --text-weight: 500;
            --text-line-height: 1.6;

            --nav-contrast: medium;
            --nav-icon-opacity: 0.8;

            --scrollbar-thumb-opacity: 0.35;
        }

        /* ========================================
           EVENING LAMP (was "Warm")
           "I need encouragement, not excitement."
           Evening lamp, human presence - NOT marketing energy
           ======================================== */
        html[data-theme="evening-lamp"],
        body[data-theme="evening-lamp"] {
            --theme-undertone: warm;
            --theme-accent-opacity: 0.8;
            --theme-contrast-level: medium;
            --theme-shadow-density: diffused;
            --theme-shadow-blur: 15px;
            --theme-glow-opacity: 0.10;
            --theme-glow-radius: 25px;
            --theme-motion-speed: 400ms;
            --theme-motion-easing: cubic-bezier(0.4, 0, 0.2, 1);

            --bg-deep: #0f0f0e;
            --bg-card: #171614;
            --bg-gradient: linear-gradient(180deg, #11100e 0%, #0f172a 100%);

            --glow-focus-color: rgba(244, 159, 117, 0.4);
            --shadow-color: rgba(20, 10, 5, 0.4);

            --border-opacity: 0.1;

            --btn-fill-opacity: 0.7;
            --btn-border-clarity: medium;

            --opacity-primary: 0.9;
            --opacity-secondary: 0.7;

            --nav-contrast: medium;
            --nav-icon-opacity: 0.8;
        }

        /* ========================================
           DESK LIGHT (was "Focus")
           "Help me think clearly."
           Desk light, clean mental space - Sharp but calm
           ======================================== */
        html[data-theme="desk-light"],
        body[data-theme="desk-light"] {
            --theme-undertone: none;
            --theme-contrast-level: high;
            --theme-shadow-density: clear;
            --theme-shadow-blur: 10px;
            --theme-shadow-y: 3px;
            --theme-glow-opacity: 0.06;
            --theme-glow-radius: 10px;
            --theme-motion-speed: 200ms;
            --theme-motion-easing: cubic-bezier(0.2, 0, 0.1, 1);
            --theme-focus-ring-strength: high;

            /* Desaturated neutral with barely perceptible cool hint */
            --bg-deep: #0f1012;
            --bg-card: #181a1c;
            --bg-gradient: linear-gradient(180deg, #0f1012 0%, #0b0c0d 100%);

            --opacity-primary: 0.95;
            --opacity-secondary: 0.75;

            --border-opacity: 0.15;
            --surface-contrast: high;

            --glow-focus-color: rgba(139, 92, 246, 0.6);

            --btn-fill-opacity: 0.7;
            --btn-border-clarity: high;

            --nav-contrast: high;
            --nav-icon-opacity: 0.9;

            --scrollbar-thumb-opacity: 0.4;
            --scrollbar-hover-boost: 0.08;
        }

        /* ========================================
           APPLY THEMED VARIABLES TO COMPONENTS
           ======================================== */

        body {
            background: var(--bg-gradient);
            color: var(--text-main);
            font-family: var(--font-body);
            font-weight: var(--font-weight-body);
            line-height: var(--line-height);
            letter-spacing: var(--letter-spacing);
            overflow-x: hidden;
            overflow-y: hidden !important;
            height: 100vh;
            width: 100vw;
            transition: background var(--transition-speed) var(--easing);
        }

        /* --- LAYOUT --- */
        .dashboard-layout {
            display: flex;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* --- SIDEBAR (Updated to match image) --- */
        .sidebar {
            width: 260px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-subtle);
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
            transition: transform var(--transition-speed) var(--easing),
                background var(--transition-speed) var(--easing);
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
            padding-left: 10px;
        }

        .user-avatar-lg {
            width: 48px;
            height: 48px;
            background: var(--bg-card);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-main);
            font-size: 1.2rem;
            border: 1px solid var(--border-subtle);
        }

        .user-info-text .name {
            font-family: var(--font-head);
            font-weight: 700;
            font-size: 1rem;
            line-height: 1.2;
        }

        .user-info-text .role {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex: 1;
        }

        .side-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 20px;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .side-link i {
            width: 20px;
            text-align: center;
        }

        .side-link:hover {
            color: var(--text-main);
            background: rgba(255, 255, 255, 0.03);
        }

        .side-link.active {
            background: rgba(45, 212, 191, 0.15);
            /* Teal Tint */
            color: var(--teal-accent);
            font-weight: 600;
            position: relative;
        }

        /* Active Indicator Line (Optional, simplified to pill for now) */

        .logout-section {
            padding-top: 20px;
            border-top: 1px solid var(--border-subtle);
        }

        /* --- MAIN CONTENT AREA --- */
        main {
            flex: 1;
            margin-left: 260px;
            /* Sidebar Width */
            padding: 20px 40px;
            /* Reduced padding from 40px 60px */
            max-width: 1400px;
        }

        /* --- CARDS & PANELS --- */
        .dash-card {
            background: transparent;
            /* REMOVED: Grey background patches */
            border: 1px solid rgba(255, 255, 255, 0.06);
            /* More subtle border */
            border-radius: 16px;
            /* Slightly reduced from 24px */
            padding: 25px;
            /* Reduced from 30px */
            margin-bottom: 20px;
            /* Reduced from 25px */
            transition: transform 0.2s ease, border-color 0.2s ease;
        }

        .dash-card:hover {
            border-color: rgba(255, 255, 255, 0.12);
            /* Slightly more visible on hover */
        }

        /* Light mode card adjustments */
        body.light-mode .dash-card {
            background: transparent;
            border-color: rgba(0, 0, 0, 0.08);
        }

        body.light-mode .dash-card:hover {
            border-color: rgba(0, 0, 0, 0.15);
        }

        /* --- TYPOGRAPHY UPDATES --- */
        h1,
        h2,
        h3,
        h4 {
            font-family: var(--font-head);
            color: var(--text-main);
        }

        /* --- BUTTONS (The TEAL!) --- */
        .btn-dash-primary {
            background: var(--teal-accent);
            color: #0f172a;
            font-weight: 700;
            font-family: var(--font-head);
            padding: 14px 32px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(45, 212, 191, 0.3);
            text-transform: none;
        }

        .btn-dash-primary:hover {
            background: #20b2aa;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(45, 212, 191, 0.4);
        }

        .btn-dash-secondary {
            background: transparent;
            color: var(--text-main);
            border: 1px solid var(--border-subtle);
            padding: 12px 28px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: var(--font-body);
        }

        .btn-dash-secondary:hover {
            border-color: var(--text-muted);
            background: rgba(255, 255, 255, 0.05);
        }

        /* --- SPECIFIC VIEWS (Home Hero) --- */
        #view-home h1 {
            font-size: 2.2rem;
            /* Reduced from 2.5rem */
            font-weight: 700;
            margin-bottom: 5px;
        }

        /* SoulBot Hero Card specific overrides to match image */
        .soulbot-hero {
            text-align: center;
            padding: 40px 30px !important;
            /* SIGNIFICANTLY REDUCED from 60px 40px */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 250px;
            /* Reduced height constraint */
        }

        .soulbot-hero i {
            font-size: 3.5rem !important;
            /* Reduced from 4rem */
            color: var(--teal-accent) !important;
            margin-bottom: 20px !important;
            /* Reduced from 25px */
            filter: drop-shadow(0 0 15px rgba(45, 212, 191, 0.4));
        }

        /* --- CHAT BUBBLES --- */
        .chat-bubble {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .chat-bubble.bot {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-subtle);
            color: var(--text-main);
            border-bottom-left-radius: 4px;
        }

        .chat-bubble.user {
            background: var(--teal-accent);
            color: #0f172a;
            align-self: flex-end;
            /* Needs flex col parent */
            border-bottom-right-radius: 4px;
            font-weight: 500;
        }

        /* --- EMOTION-FIRST HOVER STATES --- */

        /* Link Hover Base (Generic) */
        .link-hover:hover {
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.15);
        }

        /* Peer Support Cards: Warm, Inviting Expansion */
        .dash-card[style*="--peach-bg"]:hover,
        .dash-card[style*="peach"]:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: 0 10px 25px var(--peach-soft);
            border-color: var(--peach-glow) !important;
        }

        /* Professional Support Cards: Calm, Steady Lift */
        .dash-card[style*="--teal-dim"]:hover,
        .dash-card[style*="teal-dim"]:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(45, 212, 191, 0.2);
            border-color: var(--teal-accent) !important;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                /* Hidden by default */
            }

            .sidebar.open {
                transform: translateX(0);
            }

            main {
                margin-left: 0;
                padding: 20px;
            }

            .mobile-toggle {
                display: block;
                /* Ensure visible */
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                color: var(--text-main);
                padding: 10px;
                border-radius: 8px;
            }
        }

        /* FIX: Profile Avatar Contrast */
        .user-avatar-lg {
            color: var(--starlight) !important;
            /* Default Dark Mode: White */
        }

        body.light-mode .user-avatar-lg {
            color: var(--text-main) !important;
            /* Light Mode: Dark */
            background: #e2e8f0;
            /* Slightly darker bg for contrast */
            border-color: #cbd5e1;
        }

        /* FIX: Verified Badge Contrast */
        .verified-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: inline-block;
            font-weight: 500;
            background: rgba(251, 191, 36, 0.15);
            /* Gold tint */
            color: #fbbf24;
            /* Gold text default */
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        body.light-mode .verified-badge {
            background: rgba(217, 119, 6, 0.1);
            /* Darker gold/orange background */
            color: #d97706;
            /* Darker amber text for readability */
            border-color: rgba(217, 119, 6, 0.3);
        }

        /* FIX: Sidebar Link Contrast in Light Mode */
        body.light-mode .side-link {
            color: #334155;
            /* Slate-700 for better visibility */
        }

        body.light-mode .side-link:hover {
            background: rgba(0, 0, 0, 0.05);
            color: #0f172a;
            /* Slate-900 on hover */
        }

        body.light-mode .side-link.active {
            background: rgba(45, 212, 191, 0.15);
            color: #0f766e;
            /* Darker Teal for active state visibility */
        }

        /* --- FINAL POLISH (Footer & Inputs) --- */
        .sidebar-footer {
            margin-top: auto;
            border-top: 1px solid var(--border-subtle);
            padding-top: 20px;
        }

        .logout-btn {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            /* Red for logout */
            border: 1px solid rgba(239, 68, 68, 0.2);
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: 600;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        /* Settings Pills */
        .theme-btn,
        .theme-tag {
            background: var(--bg-deep);
            border: 1px solid var(--border-subtle);
            color: var(--text-muted);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: 0.2s;
        }

        .theme-btn.active,
        .theme-tag.active {
            background: var(--teal-accent);
            color: #0f172a;
            border-color: var(--teal-accent);
            font-weight: 700;
        }

        /* Form Inputs */
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        textarea {
            background: var(--bg-deep) !important;
            border: 1px solid var(--border-subtle) !important;
            color: var(--text-main) !important;
            border-radius: 12px !important;
            padding: 12px 15px !important;
            outline: none;
            transition: border-color 0.2s;
        }

        input:focus,
        textarea:focus {
            border-color: var(--teal-accent) !important;
        }

        /* --- LIGHT MODE OVERRIDES --- */
        body.light-mode,
        html.light-mode {
            --bg-deep: #f1f5f9;
            --bg-card: #ffffff;
            --bg-sidebar: #ffffff;
            --text-main: #0f172a;
            --text-primary: #0f172a;
            /* FIX: Ensure primary text is dark */
            --text-muted: #64748b;
            --text-secondary: #475569;
            /* FIX: Ensure secondary text is dark gray */
            --border-subtle: #cbd5e1;
            /* FIX: Darker border for visibility */
            --teal-dim: rgba(45, 212, 191, 0.15);
            /* Override Gradient */
            background: #f8fafc !important;
            --bg-gradient: none;
        }

        /* Light Mode Hover & Input Fixes */
        body.light-mode .side-link:hover {
            background: #e2e8f0;
            color: var(--text-main);
        }

        body.light-mode .dash-card:hover {
            border-color: rgba(0, 0, 0, 0.15);
            background: transparent;
            /* Keep transparent in light mode */
        }

        body.light-mode input,
        body.light-mode textarea {
            background: rgba(0, 0, 0, 0.02) !important;
            /* Very subtle background */
            color: #0f172a !important;
            border-color: rgba(0, 0, 0, 0.1) !important;
        }

        /* Optimize text contrast in dark mode */
        body:not(.light-mode) .dash-card h3,
        body:not(.light-mode) .dash-card label,
        body:not(.light-mode) .dash-card p {
            color: rgba(248, 250, 252, 0.95);
            /* Brighter white for better contrast */
        }

        /* Optimize muted text */
        body:not(.light-mode) [style*="opacity:0.6"],
        body:not(.light-mode) [style*="opacity:0.7"] {
            opacity: 0.85 !important;
            /* Increase from 0.6/0.7 to 0.85 */
        }


        /* Ensure sidebar uses the variable */
        .sidebar {
            background: var(--bg-sidebar);
        }
    </style>
</head>

<body>
    <!-- TOOL FRAME MODAL (Existing) -->
    <div id="toolModal" class="tool-modal-overlay">
        <div class="tool-modal-content">
            <div class="tool-modal-header">
                <div class="tool-modal-title" id="modalTitle">Tool Name</div><button class="tool-close-btn"
                    onclick="closeTool()"><i class="fas fa-times"></i></button>
            </div><iframe id="toolFrame" class="tool-frame" src=""></iframe>
        </div>
    </div>
    <!-- QUICK TOOLS MODAL (New 2x2 Grid) -->
    <div id="quickToolsModal" class="tool-modal-overlay" onclick="closeToolsModal(event)">
        <div class="tool-modal-content" style="max-width: 500px; height: auto; min-height: auto; padding-bottom: 30px;"
            onclick="event.stopPropagation()">
            <div class="tool-modal-header">
                <div class="tool-modal-title">Quick Relief</div><button class="tool-close-btn"
                    onclick="closeToolsModal()"><i class="fas fa-times"></i></button>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px;">
                <!-- Vent Box -->
                <div class="dash-card link-hover" onclick="window.location.href='../tools/vent-box.html'"
                    style="margin:0; text-align:center; padding:25px; cursor:pointer; background:rgba(239, 68, 68, 0.1); border-color:rgba(239, 68, 68, 0.2);">
                    <i class="fas fa-fire" style="font-size:2rem; color:#ef4444; margin-bottom:10px;"></i>
                    <div style="font-weight:700;">Vent Box</div>
                </div>
                <!-- Confessing -->
                <div class="dash-card link-hover" onclick="window.location.href='../tools/confession-box/index.html'"
                    style="margin:0; text-align:center; padding:25px; cursor:pointer; background:rgba(255, 255, 255, 0.05);">
                    <i class="fas fa-ghost" style="font-size:2rem; color:#e2e8f0; margin-bottom:10px;"></i>
                    <div style="font-weight:700;">Confessing</div>
                </div>
                <!-- Drop It -->
                <div class="dash-card link-hover" onclick="window.location.href='../tools/drop-it.html'"
                    style="margin:0; text-align:center; padding:25px; cursor:pointer; background:rgba(56, 189, 248, 0.1); border-color:rgba(56, 189, 248, 0.2);">
                    <i class="fas fa-hand-holding-water" style="font-size:2rem; color:#38bdf8; margin-bottom:10px;"></i>
                    <div style="font-weight:700;">Drop It</div>
                </div>
                <!-- Play -->
                <div class="dash-card link-hover" onclick="window.location.href='../tools/playground.html'"
                    style="margin:0; text-align:center; padding:25px; cursor:pointer; background:rgba(250, 176, 5, 0.1); border-color:rgba(250, 176, 5, 0.2);">
                    <i class="fas fa-shapes" style="font-size:2rem; color:#fab005; margin-bottom:10px;"></i>
                    <div style="font-weight:700;">Play</div>
                </div>
            </div>
        </div>
    </div>
    <!-- MOBILE TOGGLE --><button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <div class="dashboard-layout">
        <!-- SIDEBAR -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="user-avatar-lg"><i class="fas fa-user-astronaut"></i></div>
                <div class="user-info-text">
                    <div class="name" id="sidebar-name">Loading...</div>
                    <div class="role" id="sidebar-role">Member</div>
                </div>
            </div>
            <div class="sidebar-nav"><a href="#" class="side-link active" onclick="switchView('home', this)"
                    data-view="home"><i class="fas fa-home"></i><span>Home</span></a><a href="#" class="side-link"
                    onclick="switchView('journal', this)" data-view="journal"><i class="fas fa-book"></i><span>My
                        Journal</span></a><a href="#" class="side-link" onclick="switchView('bookings', this)"
                    data-view="bookings"><i class="fas fa-calendar-alt"></i><span>My Sessions</span></a><a href="#"
                    class="side-link" onclick="switchView('soulbot', this)" data-view="soulbot"><i
                        class="fas fa-robot"></i><span>SoulBot AI</span></a><a href="#"
                    onclick="switchView('messages', this)" data-view="messages" class="side-link"><i
                        class="fas fa-envelope"></i><span>Messages</span></a><a href="#"
                    onclick="switchView('saved', this)" class="side-link"><i
                        class="fas fa-bookmark"></i><span>Saved</span></a>
                <hr style="border:0; border-top:1px solid rgba(255,255,255,0.05); margin:10px 0;"><a href="#"
                    class="side-link" onclick="switchView('profile', this)" data-view="profile"><i
                        class="fas fa-user-circle"></i><span>My Profile</span></a><a href="#" class="side-link"
                    onclick="switchView('settings', this)" data-view="settings"><i
                        class="fas fa-cog"></i><span>Settings</span></a>
            </div>
            <div class="sidebar-footer"><button class="logout-btn" onclick="handleLogout()"><i
                        class="fas fa-sign-out-alt"></i>Log Out</button></div>
        </nav>
        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- VIEW: SETTINGS (Appearance & Preferences) -->
            <!-- VIEW: SETTINGS (Appearance & Preferences) -->
            <div id="view-settings" class="view-section" style="display:none; padding-top:0;">
                <!-- Header matching SoulBot style -->
                <style>
                    .settings-header {
                        padding: 20px;
                        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                        display: flex;
                        align-items: center;
                        gap: 15px;
                        background: transparent;
                        /* FIX: Transparent in Dark Mode too */
                        margin-bottom: 20px;
                        color: var(--starlight);
                        /* FIX: Explicitly light text in Dark Mode */
                    }

                    /* Light Mode Override for Header */
                    body.light-mode .settings-header {
                        background: transparent;
                        border-bottom: 1px solid var(--border-subtle);
                        color: var(--text-main);
                    }

                    body.light-mode .settings-icon-box {
                        background: rgba(0, 0, 0, 0.05) !important;
                        color: var(--text-main) !important;
                    }
                </style>
                <div class="settings-header">
                    <div class="settings-icon-box"
                        style="width:40px; height:40px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--text-main);">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div>
                        <h2 style="font-family:'Outfit'; font-weight:700; font-size:1.1rem; margin:0;">Settings</h2>
                        <div style="font-size:0.8rem; opacity:0.7;">Customize your space</div>
                    </div>
                </div>
                <!-- Scrollable Content -->
                <div style="max-height:calc(100vh - 180px); overflow-y:auto; padding:20px;">
                    <div class="dashboard-grid" style="grid-template-columns: 1fr;">
                        <!-- APPEARANCE CARD -->
                        <div class="dash-card">
                            <h3 style="margin-bottom:20px;">Appearance & Atmosphere</h3>
                            <!-- Mode (Light/Dark) -->
                            <div style="margin-bottom:30px;"><label
                                    style="display:block; margin-bottom:15px; font-weight:600; opacity:0.9;">Lighting
                                    Mode</label>
                                <div style="display:flex; gap:15px;"><button onclick="setThemeMode('dark')"
                                        class="theme-btn active" id="btn-mode-dark"><i class="fas fa-moon"></i>Dark
                                    </button><button onclick="setThemeMode('light')" class="theme-btn"
                                        id="btn-mode-light"><i class="fas fa-sun"></i>Light </button></div>
                            </div>
                            <style>
                                .theme-btn:hover {
                                    transform: translateY(-2px);
                                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                                }
                            </style>
                            <!-- Emotional Theme (HIDDEN FOR NOW) -->
                            <div style="margin-bottom:30px; display:none;"><label
                                    style="display:block; margin-bottom:15px; font-weight:600; opacity:0.9;">Emotional
                                    Theme</label>
                                <div style="display:flex; flex-wrap:wrap; gap:10px;"><button
                                        onclick="setEmotionalTheme('calm')" class="theme-tag active"
                                        id="btn-theme-calm">üåä
                                        Calm
                                        (Default)</button><button onclick="setEmotionalTheme('library-fog')"
                                        class="theme-tag" id="btn-theme-library-fog">üå´ Library fog</button><button
                                        onclick="setEmotionalTheme('earth-weight')" class="theme-tag"
                                        id="btn-theme-earth-weight">üå±
                                        Earth weight</button><button onclick="setEmotionalTheme('evening-lamp')"
                                        class="theme-tag" id="btn-theme-evening-lamp">‚òÄÔ∏è Evening lamp</button><button
                                        onclick="setEmotionalTheme('desk-light')" class="theme-tag"
                                        id="btn-theme-desk-light">üéØ Desk light</button></div>
                                <p style="font-size:0.85rem; opacity:0.6; margin-top:15px;">*
                                    Calm: Night, quiet, safe | Library fog: UI disappears |
                                    Earth weight: Physical stability | Evening lamp: Human presence | Desk light: Mental
                                    clarity
                                </p>
                            </div>
                        </div>
                        <!-- Profile Card Content -->
                        <div class="dash-card">
                            <h3 style="margin-bottom:20px;">Personal Information</h3>
                            <!-- Personal Details -->
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:20px;">
                                <div><label
                                        style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Full
                                        Name</label><input type="text" id="profile-name" value="Loading..."
                                        style="width:100%; padding:12px; background:var(--bg-primary); border:1px solid var(--border-soft); border-radius:10px; color:var(--text-primary); outline:none;">
                                </div>
                                <div><label
                                        style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Phone
                                        Number</label><input type="tel" id="profile-phone" value=""
                                        placeholder="Add phone number"
                                        style="width:100%; padding:12px; background:var(--bg-primary); border:1px solid var(--border-soft); border-radius:10px; color:var(--text-primary); outline:none;">
                                </div>
                            </div>
                            <!-- Login Info (Read Only) -->
                            <div style="margin-bottom:25px;"><label
                                    style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Login
                                    Method</label>
                                <div
                                    style="display:flex; align-items:center; gap:10px; padding:12px; background:rgba(255,255,255,0.03); border:1px solid var(--border-soft); border-radius:10px;">
                                    <i class="fab fa-google" style="color:var(--text-secondary);"></i><span
                                        id="profile-email"
                                        style="flex:1; color:var(--text-secondary); opacity:0.8;">loading...</span><span
                                        id="profile-verified" class="verified-badge">Verified</span>
                                </div>
                            </div>
                            <!-- Actions -->
                            <div
                                style="display:flex; gap:15px; border-top:1px solid var(--border-soft); padding-top:20px;">
                                <button class="btn-dash-primary" style="padding:10px 25px; font-size:0.95rem;">Save
                                    Changes</button><button class="btn-dash-secondary"
                                    onclick="alert('Password reset link sent to email.')">Change
                                    Password</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: PROFILE -->
            <div id="view-profile" class="view-section" style="display:none; padding-top:0;">
                <div
                    style="padding:20px; border-bottom:1px solid rgba(255,255,255,0.05); display:flex; align-items:center; gap:15px; margin-bottom:20px;">
                    <div
                        style="width:40px; height:40px; background:var(--peach-bg); border:1px solid var(--peach-border); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--peach-glow);">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div>
                        <h2 style="font-family:'Outfit'; font-weight:700; font-size:1.1rem; margin:0;">My Profile
                        </h2>
                        <div style="font-size:0.8rem; opacity:0.7;">Your personal hub</div>
                    </div>
                </div>
                <div style="max-height:calc(100vh - 180px); overflow-y:auto; padding-right:10px;">
                    <div class="dash-card" style="margin-bottom:20px;">
                        <h3 style="margin-bottom:20px;">Personal Information</h3>
                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:20px;">
                            <div><label style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Full
                                    Name</label><input type="text" id="profile-name2" value="Loading..."
                                    style="width:100%; padding:12px; background:rgba(0,0,0,0.3); border:1px solid var(--border-subtle); border-radius:10px; color:var(--text-main); outline:none;">
                            </div>
                            <div><label style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Phone
                                    Number</label><input type="tel" id="profile-phone2" placeholder="Add phone"
                                    style="width:100%; padding:12px; background:rgba(0,0,0,0.3); border:1px solid var(--border-subtle); border-radius:10px; color:var(--text-main); outline:none;">
                            </div>
                        </div>
                        <div style="margin-bottom:20px;"><label
                                style="display:block; font-size:0.85rem; opacity:0.7; margin-bottom:8px;">Email</label>
                            <div
                                style="padding:12px; background:rgba(0,0,0,0.3); border:1px solid var(--border-subtle); border-radius:10px; display:flex; align-items:center; gap:10px;">
                                <i class="fab fa-google" style="color:var(--peach-glow);"></i><span id="profile-email2"
                                    style="flex:1;">loading...</span><span class="verified-badge">Verified</span>
                            </div>
                        </div>
                        <div
                            style="display:flex; gap:10px; padding-top:15px; border-top:1px solid var(--border-subtle);">
                            <button class="btn-dash-primary">Save Changes</button>
                            <button class="btn-dash-secondary">Change Password</button>
                        </div>
                    </div>
                    <div class="dash-card" style="margin-bottom:20px;">
                        <h3 style="margin-bottom:15px; display:flex; align-items:center; gap:10px;"><i
                                class="fas fa-ghost" style="color:#8b5cf6;"></i>My Confessions</h3>
                        <div style="text-align:center; padding:40px; opacity:0.5;">
                            <i class="fas fa-ghost" style="font-size:2.5rem; margin-bottom:15px; display:block;"></i>
                            <p style="margin:0;">No confessions yet</p>
                        </div>
                    </div>
                    <div class="dash-card" style="margin-bottom:20px;">
                        <h3 style="margin-bottom:15px; display:flex; align-items:center; gap:10px;"><i
                                class="fas fa-bookmark" style="color:var(--teal-accent);"></i>Saved Content</h3>
                        <div style="text-align:center; padding:40px; opacity:0.5;">
                            <i class="fas fa-bookmark" style="font-size:2.5rem; margin-bottom:15px; display:block;"></i>
                            <p style="margin:0;">No saved items yet</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: SOULBOT CHAT -->
            <div id="view-soulbot" class="view-section" style="display:none;">
                <div class="soulbot-layout"
                    style="display:grid; grid-template-columns: 1fr 300px; gap:20px; height:calc(100vh - 120px);">
                    <!-- CHAT AREA -->
                    <div class="dash-card link-hover"
                        style="display:flex; flex-direction:column; padding:0; overflow:hidden;">
                        <!-- Header -->
                        <div
                            style="padding:20px; border-bottom:1px solid rgba(255,255,255,0.05); display:flex; justify-content:space-between; align-items:center; background:rgba(0,0,0,0.2);">
                            <div style="display:flex; gap:15px; align-items:center;">
                                <div
                                    style="width:40px; height:40px; background:var(--teal-glow); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#0f172a; font-size:1.2rem;">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <div style="font-family:'Outfit'; font-weight:700; font-size:1.1rem;">
                                        SoulBot AI </div>
                                    <div
                                        style="font-size:0.8rem; opacity:0.7; color:#22c55e; display:flex; align-items:center; gap:6px;">
                                        <i class="fas fa-circle" style="font-size:0.5rem;"></i>
                                        <span>Online & Ready to Listen</span>
                                    </div>
                                </div>
                            </div><button onclick="clearChat()"
                                style="background:transparent; border:1px solid rgba(255,255,255,0.1); color:white; padding:5px 15px; border-radius:20px; font-size:0.8rem; cursor:pointer; opacity:0.7;"><i
                                    class="fas fa-trash-alt"></i>Clear Chat </button>
                        </div>
                        <!-- Messages -->
                        <div id="soulbot-messages"
                            style="flex:1; padding:20px; overflow-y:auto; display:flex; flex-direction:column; gap:15px;">
                            <!-- Welcome Msg -->
                            <div class="chat-bubble bot">Hi there. I'm SoulBot. I' m
                                not a therapist,
                                but I'm here to listen without judgment.
                                What's on your mind today?
                            </div>
                        </div>
                        <!-- Input -->
                        <div
                            style="padding:20px; background:rgba(0,0,0,0.2); border-top:1px solid rgba(255,255,255,0.05); display:flex; gap:10px;">
                            <input type="text" id="soulbot-input" placeholder="Type your message..."
                                style="flex:1; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); padding:12px 15px; border-radius:12px; color:white; outline:none;"><button
                                onclick="sendMessage()"
                                style="background:var(--teal-glow); color:#0f172a; border:none; width:45px; height:45px; border-radius:12px; font-size:1.1rem; cursor:pointer;"><i
                                    class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                    <!-- HISTORY SIDEBAR -->
                    <div style="display:flex; flex-direction:column; gap:20px;">
                        <div class="dash-card" style="flex:1; display:flex; flex-direction:column;">
                            <h3 style="margin-bottom:15px; font-size:1.1rem;">Past
                                Conversations</h3>
                            <div style="flex:1; overflow-y:auto; display:flex; flex-direction:column; gap:10px;">
                                <div
                                    style="padding:10px; background:rgba(255,255,255,0.05); border-radius:8px; cursor:pointer; border-left:2px solid var(--teal-glow);">
                                    <div style="font-size:0.9rem; font-weight:600;">Anxiety
                                        about exams</div>
                                    <div style="font-size:0.8rem; opacity:0.6;">Yesterday
                                    </div>
                                </div>
                                <div
                                    style="padding:10px; background:transparent; border:1px solid rgba(255,255,255,0.05); border-radius:8px; cursor:pointer; opacity:0.7;">
                                    <div style="font-size:0.9rem; font-weight:600;">Feeling
                                        lonely</div>
                                    <div style="font-size:0.8rem; opacity:0.6;">3 days ago
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: HOME (Reference Design Replication - NO SCROLL) -->
            <div id="view-home" class="view-section" style="padding-top:10px;">
                <!-- Minimized Top Padding -->
                <!-- LAYER 1: GROUNDING & PRIMARY ACTION -->
                <div style="text-align:center; padding:10px 0 20px;">
                    <!-- Compact Header -->
                    <h1 id="welcome-greeting"
                        style="font-family:'Outfit'; font-size:2rem; margin-bottom:5px; color:var(--text-main);">
                        <!-- Reduced from 2.5rem -->Welcome back.
                    </h1>
                    <p style="opacity:0.8; font-size:1rem; margin-bottom:5px; color:var(--text-muted);">
                        Take a deep breath. You are safe here.</p>
                    <p style="font-size:0.85rem; margin-bottom:20px; color:var(--text-muted); font-style:italic;">
                        You can move at your own pace.</p>
                    <!-- 1. SOULBOT HERO (Compact) -->
                    <div class="dash-card soulbot-hero"
                        style="background:var(--bg-card); border:1px solid var(--border-subtle); padding:30px 20px !important; text-align:center; max-width:800px; margin:0 auto 20px; min-height:auto;">
                        <i class="fas fa-robot"
                            style="font-size:3rem; color:var(--teal-accent); margin-bottom:15px; filter:drop-shadow(0 0 15px var(--teal-dim));"></i>
                        <h2
                            style="font-family:'Outfit'; font-size:1.5rem; letter-spacing:-0.5px; color:var(--text-main); margin-bottom:8px;">
                            SoulBot is here with you. </h2>
                        <p style="color:var(--text-muted); font-size:0.9rem; margin-bottom:20px; opacity:0.8;">
                            Start where you are. We'll figure out the rest
                            together.
                        </p><button onclick="switchView('soulbot', this)" class="btn-dash-primary"
                            style="padding:12px 30px; font-size:0.95rem; box-shadow:0 0 15px var(--teal-dim);">Continue
                            with SoulBot </button>
                    </div>
                    <!-- 2. YOUR JOURNAL (Compact Strip) -->
                    <div class="dash-card"
                        style="display:flex; justify-content:space-between; align-items:center; padding:20px 30px; max-width:800px; margin:0 auto 20px;">
                        <div style="text-align:left;">
                            <h3 style="font-size:1.1rem; margin-bottom:4px; color:var(--text-main);">
                                Your Journal</h3>
                            <p style="margin:0; color:var(--text-muted); opacity:0.7; font-size:0.85rem;">
                                Write or continue your reflection.</p>
                        </div><button onclick="switchView('journal', this)"
                            style="background:transparent; border:1px solid var(--border-subtle); color:var(--text-main); padding:8px 20px; border-radius:50px; cursor:pointer; font-weight:600; font-size:0.9rem; transition:0.2s;">Open
                            Journal </button>
                    </div>
                    <!-- 3. SUPPORT SECTION (Split - Compact) -->
                    <div
                        style="margin-top:20px; margin-bottom:15px; text-align:center; opacity:0.5; font-size:0.75rem; letter-spacing:1px; font-weight:700; text-transform:uppercase; color:var(--text-muted);">
                        When you want to talk to someone </div>
                    <div class="dashboard-grid"
                        style="grid-template-columns: 1fr 1fr; gap:15px; max-width:800px; margin:0 auto;">
                        <!-- PEER TALK -->
                        <div class="dash-card link-hover" onclick="window.location.href='../our-peers/profile.html'"
                            style="text-align:center; padding:20px 15px; cursor:pointer; min-height:160px; display:flex; flex-direction:column; align-items:center; justify-content:center; background:var(--peach-bg); border:1px solid var(--peach-border); border-radius:16px; transition:all 0.3s ease;">
                            <i class="fas fa-hands-helping"
                                style="font-size:1.6rem; margin-bottom:15px; color:var(--peach-glow);"></i>
                            <h3 style="font-size:1.1rem; margin-bottom:5px; color:var(--peach-glow); font-weight:600;">
                                Talk to a Peer</h3>
                            <p style="font-size:0.85rem; color:var(--text-muted); opacity:0.8; margin:0;">
                                Someone sitting beside you.</p>
                        </div>
                        <!-- PROFESSIONAL HELP -->
                        <div class="dash-card link-hover"
                            onclick="window.location.href='../our-psychologists/about.html'"
                            style="text-align:center; padding:20px 15px; cursor:pointer; min-height:160px; display:flex; flex-direction:column; align-items:center; justify-content:center; background:var(--teal-dim); border:1px solid var(--teal-border); border-radius:16px; transition:all 0.3s ease;">
                            <i class="fas fa-user-md"
                                style="font-size:1.6rem; margin-bottom:15px; color:var(--teal-accent);"></i>
                            <h3 style="font-size:1.1rem; margin-bottom:5px; color:var(--teal-accent); font-weight:600;">
                                Professional Guidance</h3>
                            <p style="font-size:0.85rem; color:var(--text-muted); opacity:0.8; margin:0;">
                                Structured care and support.</p>
                        </div>
                    </div>
                </div>
                <!-- 4. QUICK RELAXATION TOOLS (New Tab Buttons) -->
                <div style="margin-top:20px; text-align:center;">
                    <div
                        style="opacity:0.5; font-size:0.75rem; letter-spacing:1px; font-weight:700; text-transform:uppercase; color:var(--text-muted); margin-bottom:15px;">
                        Quick Relief </div>
                    <div style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap;">
                        <button onclick="window.open('../tools/vent-box.html', '_blank')"
                            style="background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3); color:#ef4444; padding:8px 16px; border-radius:20px; font-weight:600; cursor:pointer; display:flex; gap:8px; align-items:center;"><i
                                class="fas fa-fire"></i>Vent </button><button
                            onclick="window.open('../tools/confession-box/index.html', '_blank')"
                            style="background:rgba(255,255,255,0.05); border:1px solid var(--border-subtle); color:var(--text-main); padding:8px 16px; border-radius:20px; font-weight:600; cursor:pointer; display:flex; gap:8px; align-items:center;"><i
                                class="fas fa-ghost"></i>Confess </button><button
                            onclick="window.open('../tools/drop-it.html', '_blank')"
                            style="background:rgba(56,189,248,0.1); border:1px solid rgba(56,189,248,0.3); color:#38bdf8; padding:8px 16px; border-radius:20px; font-weight:600; cursor:pointer; display:flex; gap:8px; align-items:center;"><i
                                class="fas fa-hand-holding-water"></i>Drop It
                        </button><button onclick="window.open('../tools/playground.html', '_blank')"
                            style="background:rgba(250, 176, 5, 0.1); border:1px solid rgba(250, 176, 5, 0.3); color:#fab005; padding:8px 16px; border-radius:20px; font-weight:600; cursor:pointer; display:flex; gap:8px; align-items:center;"><i
                                class="fas fa-shapes"></i>Play </button>
                    </div>
                </div>
            </div>
            <!-- VIEW: BOOKINGS (Enhanced) -->
            <!-- VIEW: BOOKINGS (Enhanced - Compact) -->
            <div id="view-bookings" class="view-section" style="display:none; padding-top:0;">
                <!-- Header matching SoulBot style -->
                <div
                    style="padding:20px; border-bottom:1px solid rgba(255,255,255,0.05); display:flex; align-items:center; gap:15px; margin-bottom:20px;">
                    <div
                        style="width:40px; height:40px; background:var(--teal-dim); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--teal-accent);">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div>
                        <h2 style="font-family:'Outfit'; font-weight:700; font-size:1.1rem; margin:0;">My Sessions
                        </h2>
                        <div style="font-size:0.8rem; opacity:0.7;">Manage your appointments</div>
                    </div>
                </div>
                <!-- TABS -->
                <div
                    style="display:flex; gap:20px; border-bottom:1px solid var(--border-soft); margin-bottom:20px; padding-bottom:5px;">
                    <div
                        style="font-weight:700; color:var(--teal-accent); border-bottom:2px solid var(--teal-accent); padding-bottom:5px; cursor:pointer;">
                        Upcoming</div>
                    <div style="opacity:0.6; cursor:pointer;">History</div>
                    <div style="opacity:0.6; cursor:pointer;">Feedback</div>
                </div>
                <div class="dashboard-grid" style="gap:20px;">
                    <!-- MAIN LIST -->
                    <div class="dash-card" style="grid-column: span 1; padding:20px;">
                        <h3 style="margin-bottom:15px; font-size:1.2rem;">
                            Upcoming Sessions</h3>
                        <!-- Empty State Placeholder -->
                        <div
                            style="text-align:center; padding:20px; background:var(--bg-deep); border-radius:12px; border:1px dashed var(--border-subtle);">
                            <i class="fas fa-calendar-check"
                                style="font-size:1.5rem; opacity:0.3; margin-bottom:10px;"></i>
                            <p style="opacity:0.7; font-size:0.9rem; margin-bottom:10px;">
                                No upcoming sessions scheduled.</p><button
                                onclick="window.location.href='../our-peers/about.html'" class="btn-dash-primary"
                                style="font-size:0.85rem; padding:8px 20px;">Book
                                a Session</button>
                        </div>
                    </div>
                    <!-- SIDEBAR: FIND HELP -->
                    <div style="display:flex; flex-direction:column; gap:15px;">
                        <!-- Book New -->
                        <div class="dash-card" style="padding:20px;">
                            <h4 style="margin-bottom:10px; font-size:1.1rem;">
                                Find Support</h4>
                            <div onclick="openTool('../our-peers/index.html', 'Browse Peers')" class="action-row peach"
                                style="margin-bottom:10px;">
                                <div
                                    style="width:30px; height:30px; background:rgba(244, 159, 117, 0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--peach-glow);">
                                    <i class="fas fa-hands-helping" style="font-size:0.9rem;"></i>
                                </div>
                                <div style="font-size:0.85rem;">Browse
                                    Peer Listeners</div>
                            </div>
                            <div onclick="openTool('../our-psychologists/psychologists.html', 'Browse Psychologists')"
                                class="action-row" style="margin-bottom:10px;">
                                <div
                                    style="width:30px; height:30px; background:rgba(78, 205, 196, 0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--teal-accent);">
                                    <i class="fas fa-user-md" style="font-size:0.9rem;"></i>
                                </div>
                                <div style="font-size:0.85rem;">Find a
                                    Psychologist</div>
                            </div>
                            <div onclick="window.open('https://www.supersaas.com/', '_blank')" class="action-row">
                                <div
                                    style="width:30px; height:30px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                                    <i class="fas fa-calendar-alt" style="font-size:0.9rem;"></i>
                                </div>
                                <div style="font-size:0.85rem;">
                                    SuperSaaS Calendar</div>
                            </div>
                        </div>
                        <!-- Credits -->
                        <div class="dash-card" style="position:relative; overflow:hidden; padding:20px;">
                            <h4 style="margin-bottom:5px; font-size:1.1rem;">
                                Wallet</h4>
                            <div style="font-size:1.8rem; font-weight:700; color:var(--text-main);">
                                $0.00</div>
                            <div style="font-size:0.8rem; opacity:0.6; margin-bottom:10px;">
                                Available Credits</div><button
                                style="width:100%; padding:8px; background:var(--bg-deep); border:1px solid var(--border-subtle); color:var(--text-main); border-radius:8px; cursor:pointer; font-size:0.9rem;">Add
                                Funds</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: JOURNAL (New - Compact) -->
            <div id="view-journal" class="view-section" style="display:none; padding-top:0;">
                <div style="display:grid; grid-template-columns: 240px 1fr; gap:20px; height:calc(100vh - 120px);">
                    <!-- Maximized Height -->
                    <!-- Sidebar -->
                    <div class="dash-card" style="padding:15px; display:flex; flex-direction:column;">
                        <button
                            style="width:100%; padding:10px; background:var(--teal-accent); color:#0f172a; border:none; border-radius:8px; font-weight:700; cursor:pointer; margin-bottom:15px; font-size:0.9rem;"><i
                                class="fas fa-plus"></i>New Entry</button>
                        <div
                            style="font-size:0.75rem; opacity:0.6; text-transform:uppercase; margin-bottom:10px; font-weight:700;">
                            Recent</div>
                        <!-- DYNAMIC LIST CONTAINER -->
                        <div id="journal-list"
                            style="flex:1; overflow-y:auto; display:flex; flex-direction:column; gap:3px;">
                            <!-- Injected via JS -->
                        </div>
                        <!-- EMPTY STATE -->
                        <div id="journal-empty" style="text-align:center; padding:20px; opacity:0.6; display:none;">
                            <i class="fas fa-pen-fancy" style="margin-bottom:10px;"></i>
                            <div style="font-size:0.8rem;">No
                                entries yet.</div>
                        </div>
                    </div>
                    <!-- Editor -->
                    <div class="dash-card" style="display:flex; flex-direction:column; padding:25px;">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                            <input type="text" value="Morning Thoughts"
                                style="background:transparent; border:none; font-size:1.4rem; font-family:var(--font-head); color:var(--text-main); flex:1; outline:none;">
                            <div style="opacity:0.5; font-size:0.85rem; white-space:nowrap; margin-left:15px;">
                                Saved</div>
                        </div><textarea
                            style="flex:1; background:transparent; border:none; resize:none; font-family:var(--font-body); font-size:1rem; line-height:1.6; color:var(--text-muted); outline:none;"
                            placeholder="Start writing..."></textarea>
                    </div>
                </div>
            </div>
            <!-- VIEW: SAVED CONTENT -->
            <div id="view-saved" class="view-section" style="display:none; padding-top:0;">
                <!-- Header matching SoulBot style -->
                <div
                    style="padding:20px; border-bottom:1px solid rgba(255,255,255,0.05); display:flex; align-items:center; gap:15px; margin-bottom:20px;">
                    <div
                        style="width:40px; height:40px; background:rgba(255,255,255,0.05); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--text-main);">
                        <i class="fas fa-bookmark"></i>
                    </div>
                    <div>
                        <h2 style="font-family:'Outfit'; font-weight:700; font-size:1.1rem; margin:0;">Saved for
                            Later
                        </h2>
                        <div style="font-size:0.8rem; opacity:0.7;">Your bookmarked content</div>
                    </div>
                </div>
                <div class="dash-card">
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <button
                            style="padding:8px 15px; background:white; color:#0f172a; border-radius:30px; border:none; font-weight:700;">All</button><button
                            style="padding:8px 15px; background:rgba(255,255,255,0.05); color:white; border-radius:30px; border:none;">Articles</button><button
                            style="padding:8px 15px; background:rgba(255,255,255,0.05); color:white; border-radius:30px; border:none;">Forum
                            Posts</button>
                    </div>
                    <div style="display:flex; flex-direction:column; gap:15px;">
                        <div
                            style="background:rgba(255,255,255,0.03); padding:20px; border-radius:12px; display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <div style="font-weight:700; margin-bottom:5px;">
                                    Understanding Anxiety Triggers</div>
                                <div style="font-size:0.8rem; opacity:0.6;">
                                    Saved 2 days ago ‚Ä¢ Blog</div>
                            </div><button
                                style="background:transparent; border:1px solid rgba(255,255,255,0.1); color:white; padding:5px 15px; border-radius:4px;">Read</button>
                        </div>
                        <div
                            style="background:rgba(255,255,255,0.03); padding:20px; border-radius:12px; display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <div style="font-weight:700; margin-bottom:5px;">
                                    "How do you handle exam stress?" </div>
                                <div style="font-size:0.8rem; opacity:0.6;">
                                    Saved 5 hours ago ‚Ä¢ Forum ‚Ä¢ 12 new replies
                                </div>
                            </div><button
                                style="background:transparent; border:1px solid rgba(255,255,255,0.1); color:white; padding:5px 15px; border-radius:4px;">View
                                Thread</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- VIEW: MESSAGES (Integrated) -->
            <div id="view-messages" class="view-section" style="display:none; height:100%; padding-top:0;">
                <div style="display:grid; grid-template-columns: 320px 1fr; gap:20px; height:calc(100vh - 120px);">
                    <!-- THREADS -->
                    <div class="dash-card" style="display:flex; flex-direction:column; padding:0; overflow:hidden;">
                        <div
                            style="padding:15px 20px; border-bottom:1px solid var(--border-subtle); font-size:0.8rem; text-transform:uppercase; letter-spacing:1px; opacity:0.6; font-weight:700;">
                            Active Threads</div>
                        <div class="thread-item active"
                            style="padding:15px 20px; border-bottom:1px solid var(--border-subtle); display:flex; gap:10px; cursor:pointer; background:rgba(255,255,255,0.05); border-left:3px solid var(--teal-accent);">
                            <div
                                style="width:40px; height:40px; background:var(--teal-accent); border-radius:50%; color:#0f172a; display:flex; align-items:center; justify-content:center;">
                                <i class="fas fa-user-md"></i>
                            </div>
                            <div style="flex:1;">
                                <div style="font-weight:600;">Dr. Emily Stone</div>
                                <div style="font-size:0.8rem; opacity:0.7;">Reflection Task</div>
                            </div>
                        </div>
                        <div class="thread-item"
                            style="padding:15px 20px; border-bottom:1px solid var(--border-subtle); display:flex; gap:10px; cursor:pointer; background:rgba(255,255,255,0.05); border-left:3px solid var(--peach-glow); opacity:0.85;">
                            <div
                                style="width:40px; height:40px; background:var(--peach-glow); border-radius:50%; color:#0f172a; display:flex; align-items:center; justify-content:center;">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div style="flex:1;">
                                <div style="font-weight:600;">Peer Sarah</div>
                                <div style="font-size:0.8rem; opacity:0.7;">Checking in...</div>
                            </div>
                        </div>
                    </div>
                    <!-- CHAT AREA -->
                    <div class="dash-card" style="display:flex; flex-direction:column; padding:0; overflow:hidden;">
                        <div
                            style="padding:15px 20px; border-bottom:1px solid var(--border-subtle); display:flex; justify-content:space-between; align-items:center;">
                            <div style="display:flex; gap:10px; align-items:center;">
                                <div
                                    style="width:35px; height:35px; background:var(--teal-accent); color:#0f172a; border-radius:50%; display:flex; align-items:center; justify-content:center;">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div>
                                    <div style="font-weight:700;">Dr. Emily Stone</div>
                                    <div style="font-size:0.8rem; opacity:0.6;">Clinical Psychologist
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div
                            style="flex:1; padding:15px; overflow-y:auto; display:flex; flex-direction:column; gap:12px; min-height:0;">
                            <div class="chat-bubble received"
                                style="background:rgba(255,255,255,0.05); align-self:flex-start; max-width:75%; padding:12px; border-radius:12px; border-bottom-left-radius:2px;">
                                Hi there. Following up on our session yesterday. Here is the reflection
                                task. <div
                                    style="margin-top:10px; background:rgba(0,0,0,0.2); padding:10px; border-radius:8px; border:1px solid var(--teal-accent);">
                                    <div style="font-weight:700; color:var(--teal-accent); margin-bottom:5px;">
                                        <i class="fas fa-pen"></i>Task: Anxiety
                                    </div>
                                    <p style="font-size:0.85rem; margin-bottom:5px;">List 3 situations
                                        this week.</p>
                                </div>
                            </div>
                            <div class="chat-bubble sent"
                                style="background:var(--teal-dim); border:1px solid var(--teal-accent); color:var(--teal-accent); align-self:flex-end; max-width:75%; padding:12px; border-radius:12px; border-bottom-right-radius:2px;">
                                Thanks Dr. Stone. I'll work on this tonight.
                            </div>
                        </div>
                        <div style="padding:15px; border-top:1px solid var(--border-subtle); display:flex; gap:10px;">
                            <input type="text" placeholder="Type a message..."
                                style="flex:1; background:rgba(0,0,0,0.2); border:1px solid var(--border-subtle); color:white; padding:10px; border-radius:8px;"><button
                                style="background:var(--teal-accent); color:#0f172a; width:40px; border-radius:8px; border:none; cursor:pointer;"><i
                                    class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- SCRIPTS -->
    <script src="../assets/js/components.js?v=3" onerror="console.error('Failed to load components.js')"></script>
    <script>function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function handleLogout() {
            sessionStorage.clear();
            window.location.href = 'logout.html';
        }

        // --- VIEW SWITCHING ---
        function switchView(viewName, clickedLink) {
            // Hide all view sections
            document.querySelectorAll('.view-section').forEach(el => el.style.display = 'none');
            // Show the target view section
            document.getElementById('view-' + viewName).style.display = 'block';

            // Update Sidebar Active State
            document.querySelectorAll('.sidebar-nav .side-link').forEach(l => l.classList.remove('active'));

            if (clickedLink) {
                clickedLink.classList.add('active');
            }

            else {
                // Fallback if clickedLink is not passed (e.g., initial load)
                const defaultLink = document.querySelector(`.sidebar-nav .side-link[data-view="${viewName}"]`);
                if (defaultLink) defaultLink.classList.add('active');
            }
        }

        // Initial view load function to check URL parameters or default
        document.addEventListener('DOMContentLoaded', () => {
            // Check if there is a 'view' query param, otherwise default to home
            // For now just defaulting to home, but logic is easy to extend
            // Also restore selected theme
            switchView('home');
        });

        // --- MODAL LOGIC ---
        function openTool(url, title) {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('toolFrame').src = url;
            document.getElementById('toolModal').classList.add('open');
        }

        function closeTool() {
            document.getElementById('toolModal').classList.remove('open');

            // Reset src to stop videos/audio
            setTimeout(() => {
                document.getElementById('toolFrame').src = '';
            }

                , 300);
        }

        // --- MOOD LOGIC ---
        function logMood(mood) {
            alert(`Mood tracked: ${mood
                }

                . This would be saved to your private journal.`);
        }

        // Initialize View
        document.addEventListener('DOMContentLoaded', () => {
            // Just default to home, theme is handled by components.js
            switchView('home');
        });


        /* SOULBOT CHAT LOGIC - Deprecated (Handled by Module below) */
        // kept empty to avoid reference errors if any onclicks linger, 
        // though module overwrites window.sendMessage.


        // Allow Enter Key
        document.getElementById("soulbot-input").addEventListener("keypress", function (e) {
            if (e.key === "Enter") sendMessage();
        });

        // Initialize View with Deep Linking
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Check for URL Param ?view=xxx
            const urlParams = new URLSearchParams(window.location.search);
            const viewParam = urlParams.get('view');

            if (viewParam) {
                switchView(viewParam);
            }

            else {
                switchView('home');
            }

            // --- JOURNAL LOGIC (Added for Empty State Demo) ---
            renderJournalSidebar();
        });

        function renderJournalSidebar() {
            const list = document.getElementById('journal-list');
            const empty = document.getElementById('journal-empty');
            // Mock Data or LocalStorage
            const stored = localStorage.getItem('my_journal_entries');

            // Default demo data if nothing stored, to show UI
            const entries = stored ? JSON.parse(stored) : [{
                title: "Morning Thoughts", date: "Today"
            }

                ,
            {
                title: "Weekly Reflection", date: "3 days ago"
            }

            ];

            // To test empty state, uncomment:
            // const entries = [];

            if (!entries || entries.length === 0) {
                list.style.display = 'none';
                empty.style.display = 'block';
            }

            else {
                list.style.display = 'flex';
                empty.style.display = 'none';
                list.innerHTML = '';

                entries.forEach(e => {
                    const div = document.createElement('div');
                    div.style.cssText = "padding:10px; background:rgba(255,255,255,0.05); border-radius:6px; font-size:0.9rem; cursor:pointer; margin-bottom:5px;";

                    div.innerHTML = `${e.title
                        }

                    <br><span style="font-size:0.7em; opacity:0.5;" >${e.date
                        }

                    </span>`;
                    list.appendChild(div);
                });
            }
        }

        // --- THEME LOGIC (Moved here for reliability) ---
        window.setThemeMode = function (mode) {
            // Target BOTH body and html to override global styles
            document.body.classList.remove('light-mode');
            document.documentElement.classList.remove('light-mode');

            if (mode === 'light') {
                document.body.classList.add('light-mode');
                document.documentElement.classList.add('light-mode');
            }

            // Update Buttons
            document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById('btn-mode-' + mode);
            if (btn) btn.classList.add('active');

            // Persist
            localStorage.setItem('soul_theme_mode', mode);
        }

            ;

        window.setEmotionalTheme = function (theme) {
            // Target BOTH body and html
            document.body.setAttribute('data-theme', theme);
            document.documentElement.setAttribute('data-theme', theme);

            // Update Buttons
            document.querySelectorAll('.theme-tag').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById('btn-theme-' + theme);
            if (btn) btn.classList.add('active');

            // Persist
            localStorage.setItem('soul_theme_emotion', theme);
        }

            ;

        // --- TOOL MODAL LOGIC (Moved here for reliability) ---
        window.openToolsModal = function () {
            document.getElementById('quickToolsModal').classList.add('open');
        }

        window.closeToolsModal = function (e) {
            if (e && e.target !== document.getElementById('quickToolsModal') && !e.target.classList.contains('tool-close-btn')) return;
            document.getElementById('quickToolsModal').classList.remove('open');
        }

        // Init Themes
        function initThemes() {
            const savedMode = localStorage.getItem('soul_theme_mode') || 'dark';
            const savedTheme = localStorage.getItem('soul_theme_emotion') || 'calm';
            setThemeMode(savedMode);
            setEmotionalTheme(savedTheme);
        }

        // Run Init
        initThemes();

    </script>
    <script type="module">import {
            createConversation,
            addMessageToConversation,
            subscribeToConversation
        }

            from "../assets/js/soulbot-handler.js";

        let currentConversationId = localStorage.getItem('soulbot_conversation_id');
        let unsubscribe = null;
        const msgContainer = document.getElementById('soulbot-messages');
        const inputField = document.getElementById('soulbot-input');

        // --- INITIALIZATION ---
        async function initSoulBotChat() {
            if (!currentConversationId) {
                // Create new conversation
                // TODO: Pass actual userId if logged in
                currentConversationId = await createConversation("anonymous_user");

                if (currentConversationId) {
                    localStorage.setItem('soulbot_conversation_id', currentConversationId);
                }
            }

            // Subscribe to updates
            if (currentConversationId) {
                if (unsubscribe) unsubscribe(); // Clear old sub if any
                unsubscribe = subscribeToConversation(currentConversationId, renderMessages);
            }
        }

        // --- RENDER LOGIC ---
        function renderMessages(conversationData) {
            if (!conversationData || !conversationData.messages) return;

            // Clear current (simple re-render for MVP)
            msgContainer.innerHTML = '';

            // Add Welcome Message Always
            if (conversationData.messages.length === 0) {
                msgContainer.innerHTML = ` <div class="chat-bubble bot">Hi there. I'm SoulBot. I' m not a therapist,
                but I'm here to listen without judgment.
 What's on your mind today?
 </div>`;
            }

            conversationData.messages.forEach(msg => {
                const div = document.createElement('div');

                div.className = `chat-bubble ${msg.role === 'user' ? 'user' : 'bot'
                    }

                    `;
                // Simple text rendering (could add markdown support later)
                div.innerText = msg.text;
                msgContainer.appendChild(div);
            });

            // Scroll to bottom
            msgContainer.scrollTop = msgContainer.scrollHeight;
        }

        // --- GLOBAL ACTIONS (Expose to window for onclick) ---
        window.sendMessage = async function () {
            const text = inputField.value.trim();
            if (!text) return;

            // UI: Clear immediately for responsiveness
            inputField.value = '';

            // Core: Send to Backend
            if (currentConversationId) {
                await addMessageToConversation(currentConversationId, 'user', text);

                // Mock Bot Reply (Temporary until Cloud Function/Backend Service is active)
                // In a real app, a Cloud Function triggers on Firestore write.
                // Here we simulate it locally for demonstration if needed, 
                // BUT the robust way is backend. 
                // For now, let's let the user know if no backend is responding.
                // setTimeout(() => addMessageToConversation(currentConversationId, 'bot', "I hear you. (AI Backend Integration required for full reply)"), 1000);
            }
        }

            ;

        window.clearChat = function () {
            if (confirm("Start a new conversation?")) {
                localStorage.removeItem('soulbot_conversation_id');
                currentConversationId = null;
                initSoulBotChat();
            }
        }

            ;

        // Start
        initSoulBotChat();

    </script>
    <!-- DASHBOARD HYDRATION SCRIPT -->
    <script type="module">import {
            onAuthChange
        }

            from "../assets/js/auth-service.js";

        import {

            getUserProfile,
            createOrUpdateUserProfile
        }

            from "../assets/js/profile-handler.js";

        document.addEventListener('DOMContentLoaded', () => {
            onAuthChange(async (user) => {
                if (user) {
                    // 1. Get Profile
                    let profile = await getUserProfile(user.uid);

                    // 2. If no profile, try to create one (recovery)
                    if (!profile) {
                        console.info("Profile missing in dashboard, attempting recovery...");
                        await createOrUpdateUserProfile(user);
                        profile = await getUserProfile(user.uid);
                    }

                    if (profile) {
                        // 3. Update UI
                        const name = profile.displayName || user.displayName || 'Friend';
                        const email = profile.email || user.email;
                        const phone = profile.phone || '';

                        // Personal Greeting
                        const greetingEl = document.getElementById('welcome-greeting');

                        if (greetingEl) greetingEl.innerHTML = `Welcome back, <span style="color:var(--teal-accent);" >${name
                            }

                                </span>.`;

                        // URL Masking (Client-Side Routing Feel) - Makes it look personalized
                        // Only change if not already clean (avoids loop)
                        if (window.history && window.history.replaceState) {
                            // Use replaceState to change URL bar without reload
                            // From: /portal/user-dashboard.html
                            // To:   /portal/my-space
                            const cleanUrl = window.location.href.replace('user-dashboard.html', 'my-space');
                            // window.history.replaceState({}, document.title, cleanUrl);
                            // CAUTION: Only do this if we are confident user won't 404 on refresh.
                            // Since we don't control server rewrites yet, let's stick to a safe query param or hash for now to be safe?
                            // User explicitly asked for "redirected to HIS page". 
                            // Let's settle for a visual hash for now which is 100% safe: #/my-space/aditya
                            // OR just update the greeting as the main "Personal" indicator as per my plan.

                            // Let's go with the greeting update as the primary "Personalization" proof.
                            // And maybe add a hash:
                            // window.location.hash = `/space/${user.uid}`;
                        }

                        // Sidebar
                        const sbName = document.getElementById('sidebar-name');
                        if (sbName) sbName.innerText = name;

                        const sbRole = document.getElementById('sidebar-role');
                        if (sbRole) sbRole.innerText = (profile.role || 'Member');

                        // Settings inputs
                        const inName = document.getElementById('profile-name');
                        if (inName) inName.value = name;

                        const inPhone = document.getElementById('profile-phone');
                        if (inPhone) inPhone.value = phone;

                        const elEmail = document.getElementById('profile-email');
                        if (elEmail) elEmail.innerText = email;

                    }
                }

                else {
                    console.log("No user found in dashboard.");
                }
            });
        });

    </script>


    <!-- FLOATING TOOLS BUTTON & MENU -->
    <button id="tools-fab" onclick="toggleToolsMenu()"
        style="position:fixed; bottom:30px; right:30px; width:56px; height:56px; border-radius:50%; background:var(--peach-glow); border:none; cursor:pointer; box-shadow:0 4px 12px rgba(244,159,117,0.4); display:flex; align-items:center; justify-content:center; z-index:1000; transition:all 0.3s ease;">
        <i class="fas fa-toolbox" style="font-size:1.4rem; color:#0f172a;"></i>
    </button>

    <!-- TOOLS SLIDE-OUT MENU -->
    <div id="tools-menu"
        style="position:fixed; top:0; right:-350px; width:350px; height:100vh; background:var(--bg-card); border-left:1px solid var(--border-subtle); z-index:999; transition:right 0.3s ease; display:flex; flex-direction:column; box-shadow:-4px 0 20px rgba(0,0,0,0.3);">
        <!-- Header -->
        <div
            style="padding:20px; border-bottom:1px solid var(--border-subtle); display:flex; justify-content:space-between; align-items:center; background:rgba(0,0,0,0.2);">
            <div>
                <h3 style="margin:0; font-family:'Outfit'; font-size:1.2rem;">Self-Help Tools</h3>
                <p style="margin:5px 0 0 0; font-size:0.8rem; opacity:0.7;">Quick access to all tools</p>
            </div>
            <button onclick="toggleToolsMenu()"
                style="background:transparent; border:none; color:var(--text-main); cursor:pointer; font-size:1.5rem; opacity:0.7; padding:5px;">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Tools List -->
        <div style="flex:1; overflow-y:auto; padding:15px;">
            <!-- Vent Box -->
            <div onclick="window.open('../tools/vent-box.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(239,68,68,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-fire" style="color:#ef4444; font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem; color:#ef4444;">Vent Box</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Release frustration safely</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>

            <!-- Confession Box -->
            <div onclick="window.open('../tools/confession-box/index.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.3); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(139,92,246,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-ghost" style="color:#8b5cf6; font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem; color:#8b5cf6;">Confession Box</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Share anonymously</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>

            <!-- Drop It -->
            <div onclick="window.open('../tools/drop-it.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(56,189,248,0.1); border:1px solid rgba(56,189,248,0.3); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(56,189,248,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-hand-holding-water" style="color:#38bdf8; font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem; color:#38bdf8;">Drop It</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Let go of worries</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>

            <!-- Playground -->
            <div onclick="window.open('../tools/playground.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(250,176,5,0.1); border:1px solid rgba(250,176,5,0.3); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(250,176,5,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-shapes" style="color:#fab005; font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem; color:#fab005;">Playground</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Creative relief</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>

            <!-- Breathing Exercise -->
            <div onclick="window.open('../tools/breathing.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(45,212,191,0.1); border:1px solid rgba(45,212,191,0.3); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(45,212,191,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-wind" style="color:var(--teal-accent); font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem; color:var(--teal-accent);">Breathing</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Calm your mind</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>

            <!-- Reset Tool -->
            <div onclick="window.open('../tools/reset.html', '_blank')" class="tool-item"
                style="padding:15px; background:rgba(255,255,255,0.05); border:1px solid var(--border-subtle); border-radius:12px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;">
                <div style="display:flex; align-items:center; gap:12px;">
                    <div
                        style="width:40px; height:40px; background:rgba(255,255,255,0.1); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i class="fas fa-redo-alt" style="color:var(--text-main); font-size:1.1rem;"></i>
                    </div>
                    <div style="flex:1;">
                        <h4 style="margin:0; font-size:1rem;">Reset</h4>
                        <p style="margin:3px 0 0 0; font-size:0.75rem; opacity:0.7;">Start fresh</p>
                    </div>
                    <i class="fas fa-external-link-alt" style="opacity:0.5; font-size:0.9rem;"></i>
                </div>
            </div>
        </div>
    </div>

    <style>
        .tool-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        #tools-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(244, 159, 117, 0.6);
        }
    </style>

    <script>
        function toggleToolsMenu() {
            const menu = document.getElementById('tools-menu');
            const fab = document.getElementById('tools-fab');
            const isOpen = menu.style.right === '0px';

            if (isOpen) {
                menu.style.right = '-350px';
                fab.style.transform = 'rotate(0deg)';
            } else {
                menu.style.right = '0px';
                fab.style.transform = 'rotate(180deg)';
            }
        }

        // Close menu when clicking outside
        document.addEventListener('click', function (event) {
            const menu = document.getElementById('tools-menu');
            const fab = document.getElementById('tools-fab');
            if (menu && fab && !menu.contains(event.target) && !fab.contains(event.target) && menu.style.right === '0px') {
                toggleToolsMenu();
            }
        });
    </script>

</body>

</html>